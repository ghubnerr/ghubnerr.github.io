<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Panel</title>
  </head>
  <body>
    <h1>Netlify CMS Admin Panel</h1>
    <div id="ncms"></div>

    <!-- Include the Netlify Identity widget -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

    <!-- Include the Netlify CMS script -->
    <script src="https://cdn.jsdelivr.net/npm/netlify-cms@2.10.1/dist/netlify-cms.js"></script>

    <script>
      // Initialize the Netlify Identity widget
      netlifyIdentity.init();

      // Initialize Netlify CMS
      window.CMS_INIT = () => {
        CMS.init({
          config: "/admin/config.yml", // Your Netlify CMS config file
        });
      };

      // Handle login event
      netlifyIdentity.on("login", (user) => {
        console.log("Logged in as:", user);
        window.location.href = "/admin/";
      });

      // Handle logout event
      netlifyIdentity.on("logout", () => {
        console.log("Logged out");
        window.location.href = "/";
      });

      // Check if the user is already logged in
      if (netlifyIdentity.currentUser()) {
        console.log("Already logged in:", netlifyIdentity.currentUser());
      }

      // Wait for the page to fully load before initializing the CMS
      window.onload = () => {
        CMS_INIT(); // Start CMS initialization
      };
    </script>
  </body>
</html>
